# Phase 3: AI 功能完整測試計劃

## 📋 測試概要

**測試目標**: 驗證 Vibe Commerce Phase 3 所有 AI 功能正常運作
**測試環境**: 線上部署環境
**預計時間**: 30-45 分鐘
**測試日期**: _____________
**測試人員**: _____________

---

## ✅ 前置準備檢查清單

在開始測試前，請確認以下項目：

- [ ] 後端服務已部署並運行
- [ ] 前端服務已部署並運行
- [ ] Gemini API Key 已設定為 Cloudflare Secret
- [ ] 資料庫已執行 migrations
- [ ] 商品已完成向量化（至少 3 個商品）
- [ ] Clerk 認證系統正常運作
- [ ] 已準備測試帳號（用於登入測試）

### 驗證部署狀態

```bash
# 檢查後端健康狀態
curl https://your-worker-url.workers.dev/health

# 預期回應:
# {
#   "status": "healthy",
#   "timestamp": "...",
#   "uptime": "edge-deployed"
# }
```

---

## 🧪 測試案例

### 測試分類
1. **功能性測試** - 驗證功能是否正常運作
2. **效能測試** - 驗證回應時間和載入速度
3. **使用者體驗測試** - 驗證介面流暢度和動畫效果
4. **錯誤處理測試** - 驗證異常情況處理

---

## 📝 測試案例 1: 語義搜尋功能

### 1.1 基本搜尋測試

**測試步驟**:
1. 訪問首頁或 Dashboard (`/dashboard`)
2. 在搜尋框中輸入: `wireless headphones`
3. 觀察搜尋結果

**預期結果**:
- [ ] 搜尋框出現載入動畫（旋轉圖示）
- [ ] 500ms 內顯示下拉搜尋結果
- [ ] 結果包含相關商品（至少 1 個）
- [ ] 商品卡片包含：
  - [ ] 商品圖片（如果有）
  - [ ] 商品名稱
  - [ ] 品牌和類別
  - [ ] 價格
  - [ ] 相似度評分（如果 >70%）
- [ ] 顯示搜尋方法指示（✨ AI-powered search 或 🔍 Keyword search）

**測試變化**:

| 測試輸入 | 預期商品 | 結果 ✓/✗ | 備註 |
|---------|---------|---------|------|
| `wireless headphones` | Premium Wireless Headphones | [ ] | |
| `fitness tracker` | Smart Fitness Watch | [ ] | |
| `comfortable clothes` | Organic Cotton T-Shirt | [ ] | |
| `tech gifts` | 電子產品類 | [ ] | |
| `運動裝備` | 運動相關商品 | [ ] | 中文測試 |

### 1.2 空結果測試

**測試步驟**:
1. 輸入不存在的商品: `flying carpet`
2. 觀察結果

**預期結果**:
- [ ] 顯示「No results found」訊息
- [ ] 提示嘗試不同關鍵字
- [ ] 介面不崩潰

### 1.3 搜尋方法驗證

**測試步驟**:
1. 使用精確關鍵字搜尋（如 `AudioTech`）
2. 使用模糊描述搜尋（如 `noise cancelling audio device`）

**預期結果**:
- [ ] 精確關鍵字：可能顯示 `🔍 Keyword search`
- [ ] 模糊描述：應顯示 `✨ AI-powered search`
- [ ] 兩種情況都能返回相關結果

### 1.4 搜尋效能測試

**測試指標**:
- [ ] 首次搜尋響應時間: _____ ms（目標: <1000ms）
- [ ] 後續搜尋響應時間: _____ ms（目標: <500ms）
- [ ] 連續輸入時防抖動正常
- [ ] 不會發送過多 API 請求

---

## 📝 測試案例 2: AI 聊天助手

### 2.1 開啟聊天視窗

**測試步驟**:
1. 確認已登入
2. 點擊右下角紫色懸浮按鈕
3. 觀察聊天視窗

**預期結果**:
- [ ] 懸浮按鈕顯示在正確位置（右下角）
- [ ] 按鈕有 hover 放大效果
- [ ] 點擊後聊天視窗順暢彈出
- [ ] 視窗尺寸正確（約 400x600px）
- [ ] 顯示歡迎訊息
- [ ] 視窗可以關閉

### 2.2 基本對話測試

**測試步驟**:
1. 在聊天框輸入: `Hello, what products do you have?`
2. 點擊發送或按 Enter
3. 觀察 AI 回應

**預期結果**:
- [ ] 用戶訊息立即顯示（紫藍漸變背景）
- [ ] 出現載入動畫
- [ ] AI 回應以串流方式顯示（逐字出現）
- [ ] 有閃爍游標動畫（▮）
- [ ] 回應內容相關且有幫助
- [ ] 自動滾動到最新訊息

**測試對話範例**:

| 問題 | 預期回應類型 | 是否通過 ✓/✗ | 備註 |
|------|-------------|-------------|------|
| `What are your best-selling products?` | 列出商品或類別 | [ ] | |
| `I need a gift for a tech lover under $200` | 推薦特定商品 | [ ] | |
| `Tell me about your wireless headphones` | 描述商品特點 | [ ] | |
| `What's your return policy?` | 引導到官方頁面 | [ ] | |
| `Can you modify my account?` | 拒絕並引導到設定 | [ ] | 測試限制 |

### 2.3 對話上下文測試

**測試步驟**:
1. 輸入: `What wireless products do you have?`
2. 等待回應
3. 接著輸入: `Tell me more about the first one`
4. 觀察回應

**預期結果**:
- [ ] AI 能記住前一個問題的內容
- [ ] 回應具有連貫性
- [ ] 對話歷史正確保存

### 2.4 SSE 串流測試

**測試步驟**:
1. 輸入較長的問題或請求詳細說明
2. 觀察回應過程

**預期結果**:
- [ ] 文字逐字或逐段出現
- [ ] 沒有長時間等待
- [ ] 沒有卡頓或凍結
- [ ] 可以看到打字效果

### 2.5 錯誤處理測試

**測試步驟**:
1. 關閉網路連接
2. 嘗試發送訊息
3. 觀察錯誤處理

**預期結果**:
- [ ] 顯示錯誤訊息
- [ ] 介面不崩潰
- [ ] 可以重試

### 2.6 速率限制測試

**測試步驟**:
1. 快速連續發送 20+ 個訊息
2. 觀察系統反應

**預期結果**:
- [ ] 達到限制時顯示 429 錯誤
- [ ] 錯誤訊息清楚說明限制
- [ ] 顯示重試等待時間
- [ ] 限制: 20 次/15 分鐘

---

## 📝 測試案例 3: 個人化推薦

### 3.1 推薦顯示測試

**測試步驟**:
1. 確認已登入
2. 訪問 Dashboard (`/dashboard`)
3. 滾動到推薦區塊

**預期結果**:
- [ ] 顯示「Recommended for You」標題
- [ ] 顯示推薦類型標籤（Personalized / Popular）
- [ ] 商品卡片以網格排列（1-4 列）
- [ ] 卡片有交錯淡入動畫
- [ ] 每張卡片延遲約 0.1 秒出現

### 3.2 推薦卡片內容測試

**測試步驟**:
1. 檢查推薦商品卡片
2. 測試 hover 互動

**預期結果**:
- [ ] 每張卡片包含：
  - [ ] 商品圖片
  - [ ] 商品名稱
  - [ ] 品牌和類別
  - [ ] 價格
  - [ ] 庫存狀態
  - [ ] AI Pick 徽章（如果是個人化推薦）
- [ ] Hover 效果：
  - [ ] 卡片陰影增強
  - [ ] 圖片輕微放大
  - [ ] 過渡流暢

### 3.3 推薦相關性測試

**測試步驟**:
1. 先進行一些搜尋和瀏覽
2. 重新載入 Dashboard
3. 檢查推薦是否改變

**預期結果**:
- [ ] 推薦基於最近活動
- [ ] 顯示「Personalized」標籤
- [ ] 推薦商品與瀏覽歷史相關

### 3.4 無歷史記錄測試

**測試步驟**:
1. 使用新帳號（無互動歷史）
2. 訪問 Dashboard

**預期結果**:
- [ ] 仍然顯示推薦
- [ ] 顯示「Popular」標籤
- [ ] 推薦熱門商品

---

## 📝 測試案例 4: AI Demo 展示頁面

### 4.1 頁面載入測試

**測試步驟**:
1. 訪問 `/ai-demo`
2. 觀察頁面載入

**預期結果**:
- [ ] 頁面正常載入
- [ ] 所有區塊正確顯示
- [ ] 響應式佈局正常

### 4.2 功能展示測試

**測試步驟**:
1. 檢查頁面各個區塊
2. 測試每個展示的功能

**預期結果**:
- [ ] 語義搜尋區塊：搜尋框可用
- [ ] 推薦區塊：顯示推薦商品
- [ ] AI 聊天說明：描述清楚
- [ ] Phase 3 功能列表：完整顯示
- [ ] 所有連結和按鈕可點擊

---

## 📝 測試案例 5: 跨瀏覽器與裝置測試

### 5.1 桌面瀏覽器測試

**測試瀏覽器**:
- [ ] Chrome/Edge (Chromium)
- [ ] Firefox
- [ ] Safari (如果可用)

**測試項目**:
- [ ] 所有功能正常運作
- [ ] UI 顯示正確
- [ ] 動畫流暢
- [ ] 無 console 錯誤

### 5.2 行動裝置測試

**測試步驟**:
1. 使用手機或平板訪問網站
2. 測試所有主要功能

**預期結果**:
- [ ] 響應式設計正確
- [ ] 搜尋框適應螢幕寬度
- [ ] 聊天視窗在小螢幕上可用
- [ ] 推薦卡片正確堆疊
- [ ] 觸控互動正常

### 5.3 不同螢幕尺寸測試

**測試尺寸**:
- [ ] 手機 (320px - 480px)
- [ ] 平板 (768px - 1024px)
- [ ] 筆電 (1366px - 1920px)
- [ ] 大螢幕 (>1920px)

---

## 📝 測試案例 6: 效能與優化測試

### 6.1 首次載入效能

**測試步驟**:
1. 清除瀏覽器快取
2. 訪問首頁
3. 使用開發者工具測量

**測試指標**:
- [ ] 首次內容繪製 (FCP): _____ ms（目標: <1.8s）
- [ ] 最大內容繪製 (LCP): _____ ms（目標: <2.5s）
- [ ] 首次輸入延遲 (FID): _____ ms（目標: <100ms）
- [ ] 累積版面配置偏移 (CLS): _____（目標: <0.1）

### 6.2 API 響應時間測試

**測試項目**:

| API 端點 | 響應時間 (ms) | 目標 | 是否達標 ✓/✗ |
|---------|-------------|------|-------------|
| `/health` | _____ | <100ms | [ ] |
| `/api/search` | _____ | <1000ms | [ ] |
| `/api/ai/chat` (首字) | _____ | <500ms | [ ] |
| `/api/ai/recommendations` | _____ | <1500ms | [ ] |

### 6.3 並發處理測試

**測試步驟**:
1. 同時開啟多個分頁
2. 在每個分頁中測試功能
3. 觀察效能

**預期結果**:
- [ ] 所有分頁功能正常
- [ ] 沒有明顯延遲
- [ ] 速率限制正確執行

---

## 📝 測試案例 7: 安全性與錯誤處理

### 7.1 認證測試

**測試步驟**:
1. 未登入狀態訪問 AI 功能
2. 嘗試使用聊天和推薦

**預期結果**:
- [ ] AI 聊天按鈕不顯示（未登入）
- [ ] 推薦功能不顯示（未登入）
- [ ] 搜尋功能仍可使用（公開功能）

### 7.2 輸入驗證測試

**測試步驟**:
1. 在聊天框輸入特殊字符
2. 輸入超長文字（>1000 字）
3. 輸入空白訊息

**預期結果**:
- [ ] 特殊字符被正確處理（不破壞 UI）
- [ ] 超長文字被截斷或拒絕
- [ ] 空白訊息無法發送
- [ ] 顯示適當的錯誤訊息

### 7.3 API 錯誤處理測試

**測試步驟**:
1. 暫時停止後端服務（如果可行）
2. 嘗試使用 AI 功能
3. 觀察錯誤處理

**預期結果**:
- [ ] 顯示友好的錯誤訊息
- [ ] 不顯示技術錯誤詳情
- [ ] 介面不崩潰
- [ ] 提供重試選項

---

## 📝 測試案例 8: 使用者體驗 (UX) 測試

### 8.1 視覺一致性測試

**檢查項目**:
- [ ] 顏色方案一致（紫藍漸變）
- [ ] 字體大小和樣式統一
- [ ] 按鈕和互動元素風格一致
- [ ] 間距和對齊正確

### 8.2 動畫流暢度測試

**測試動畫**:
- [ ] 聊天視窗開關動畫
- [ ] 打字效果流暢
- [ ] 推薦卡片淡入動畫
- [ ] Hover 效果過渡自然
- [ ] 載入動畫不卡頓

### 8.3 無障礙測試 (Accessibility)

**測試項目**:
- [ ] 鍵盤導航可用（Tab 鍵）
- [ ] Enter 鍵可發送訊息
- [ ] 按鈕有清楚的 aria-label
- [ ] 顏色對比度足夠
- [ ] 文字大小可讀

---

## 📝 測試案例 9: 端到端情境測試

### 情境 1: 新用戶首次體驗

**步驟**:
1. 註冊新帳號
2. 完成 onboarding（如果有）
3. 瀏覽首頁
4. 使用搜尋功能找商品
5. 使用 AI 聊天詢問問題
6. 查看推薦商品
7. 訪問 AI Demo 頁面

**記錄**:
- 是否順暢: [ ] 是 [ ] 否
- 遇到的問題: _________________________
- 整體評分 (1-5): _____

### 情境 2: 購物諮詢流程

**步驟**:
1. 登入帳號
2. 打開 AI 聊天
3. 詢問: "I need a gift for my friend who loves tech, budget $200"
4. 根據建議搜尋商品
5. 查看商品詳情
6. 再次詢問 AI 更多問題

**記錄**:
- AI 建議是否有幫助: [ ] 是 [ ] 否
- 找到合適商品: [ ] 是 [ ] 否
- 整體體驗評分 (1-5): _____

### 情境 3: 回訪用戶體驗

**步驟**:
1. 使用有歷史記錄的帳號
2. 查看個人化推薦
3. 進行新的搜尋
4. 使用 AI 聊天

**記錄**:
- 推薦是否相關: [ ] 是 [ ] 否
- 與新用戶體驗差異: _________________________

---

## 📊 測試結果統計

### 功能測試結果

| 測試項目 | 通過數 | 失敗數 | 通過率 | 嚴重問題 |
|---------|--------|--------|--------|---------|
| 語義搜尋 | ___/10 | ___ | ___% | ___ |
| AI 聊天 | ___/12 | ___ | ___% | ___ |
| 個人化推薦 | ___/8 | ___ | ___% | ___ |
| Demo 頁面 | ___/5 | ___ | ___% | ___ |
| 跨瀏覽器 | ___/6 | ___ | ___% | ___ |
| 效能測試 | ___/8 | ___ | ___% | ___ |
| 安全性 | ___/6 | ___ | ___% | ___ |
| UX 測試 | ___/9 | ___ | ___% | ___ |
| **總計** | **___/64** | **___** | **___%** | **___** |

### 效能指標摘要

| 指標 | 測量值 | 目標值 | 是否達標 |
|------|--------|--------|---------|
| 搜尋響應時間 | ___ms | <1000ms | [ ] |
| AI 首字響應 | ___ms | <500ms | [ ] |
| 頁面載入時間 | ___s | <3s | [ ] |
| API 可用性 | ___%  | >99% | [ ] |

---

## 🐛 發現的問題清單

### 嚴重問題 (P0) - 阻礙核心功能

| # | 問題描述 | 重現步驟 | 影響範圍 | 狀態 |
|---|---------|---------|---------|------|
| 1 | | | | |
| 2 | | | | |

### 重要問題 (P1) - 影響用戶體驗

| # | 問題描述 | 重現步驟 | 影響範圍 | 狀態 |
|---|---------|---------|---------|------|
| 1 | | | | |
| 2 | | | | |

### 次要問題 (P2) - 小瑕疵或建議

| # | 問題描述 | 重現步驟 | 影響範圍 | 狀態 |
|---|---------|---------|---------|------|
| 1 | | | | |
| 2 | | | | |

---

## 💡 改進建議

### 功能改進
1. _________________________________
2. _________________________________
3. _________________________________

### 效能優化
1. _________________________________
2. _________________________________
3. _________________________________

### UX 改進
1. _________________________________
2. _________________________________
3. _________________________________

---

## 📋 測試完成檢查清單

- [ ] 所有測試案例已執行
- [ ] 效能指標已記錄
- [ ] 問題清單已整理
- [ ] 測試結果已統計
- [ ] 改進建議已提出
- [ ] 測試報告已歸檔

---

## 📞 需要協助？

**文檔參考**:
- `/docs/PHASE_3_USAGE.md` - 使用指南
- `/docs/PHASE_3_COMPLETED.md` - 完成報告
- `/PHASE_3_QUICKSTART.md` - 快速開始

**常見問題**:
- API 錯誤: 檢查 Gemini API Key 配置
- 搜尋無結果: 確認商品已向量化
- 聊天無回應: 檢查認證狀態

---

**測試完成日期**: _____________
**測試人員簽名**: _____________
**審核人員簽名**: _____________

---

## 附錄: 快速測試命令

### API 健康檢查
```bash
curl https://your-worker-url.workers.dev/health
```

### 測試搜尋 API
```bash
curl "https://your-worker-url.workers.dev/api/search?query=wireless"
```

### 檢查商品向量化狀態
```bash
# 在後端目錄執行
npm run check-products
```

### 查看 Cloudflare Workers 日誌
```bash
wrangler tail
```

---

**版本**: 1.0.0
**最後更新**: 2026-01-13
**適用版本**: Phase 3 完整發布
